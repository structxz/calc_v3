# Распределенный вычислитель арифметических выражений[^1]

## Описание проекта

Этот проект представляет собой распределенную систему для вычисления математических выражений. Он состоит из:

- **Оркестратора** – управляет вычислениями и распределяет задачи между агентами.
- **Агентов** – выполняют вычисления по запросу оркестратора.

## Функциональность

- Поддержка базовых арифметических операций (`+`, `-`, `*`, `/`).
- Возможность работы с выражениями, содержащими произвольное количество пробелов.
- Распределение вычислений между несколькими агентами.
- Логирование запросов и результатов вычислений.

## Структура проекта

```
project-root/
│
│── cmd/
│   ├── orchestrator/      # Главный модуль оркестратора
│   ├── agent/             # Главный модуль агента
│
│── configs/
│
│── internal/
│   ├── app/               # Логика оркестратора
│   ├── constants/         # Константы приложения
│   ├── logger/            # Логгер приложения
│   ├── worker/            # Логика вычислений
│
│── logs/                  
│	│── agent/             # Логи агента
│	│── orchestrator/      # Логи оркестратора
│
│── test/                  # Тесты проекта
│
│── pkg/                   # Логика вычислений
│
│── .env                   # Переменные окружения
│
│── docker-compose.yml     # Запуск через Docker Compose
│── README.md              # Документация проекта
```

## Запуск проекта

### Локальный запуск

1. **Склонируйте репозиторий:**
   ```sh
   git clone <репозиторий>
   cd <папка_проекта>
   ```
2. **Запустите систему:**
   ```sh
   go run ./cmd/...
   ```
3. **Отправьте выражение на вычисление:**
   ```sh
   curl -L 'http://localhost:8080/api/v1/calculate' -H 'Content-Type: application/json' --data '{"expression":"2*3"}'
   ```

### Использование Docker

#### Запуск
1. **Соберите контейнеры и запустите их:**
   ```sh
    docker-compose up -d --build
   ```
   ```sh
   docker-compose up -d --scale agent=x
   ```
   x - параметр, который вы сами задаете, обозначающий кол-во агентов 
2. **Отправьте запрос на вычисление (аналогично локальному запуску).**

#### Остановка
   ```sh
   docker-compose stop
   ```
#### Удаление
```sh
docker-compose down
```


## Примеры запросов с `curl`

### Успешный запрос

```sh
curl -L 'http://localhost:8080/api/v1/calculate' -H 'Content-Type: application/json' --data '{"expression":"2+3"}'  
```

**Ответ:**

```json
{
  "id": "65591540-1000-47dd-b138-f42640ce85e8"
}
```

### Ошибочный запрос (некорректное выражение)

```sh
curl -L 'http://localhost:8080/api/v1/calculate' -H 'Content-Type: application/json' --data '{"expression":"some expression"}'
```

**Ответ:**

```json
{
  "error":"invalid expression: unexpected character 's'"
}
```

### Список всех выражений
#### Запрос
```sh
curl --location 'http://localhost:8080/api/v1/expressions'
```
#### Ответ
```json
{  
  
    "expressions": [  
        {  
            "id": "123e4567-e89b-12d3-a456-426614174000",  
            "expression": "2+2*2",  
            "status": "COMPLETE",  
            "result": 6  
        },  
        {  
            "id": "987fcdeb-51d3-12a4-b678-426614174000",  
            "expression": "10-5",  
            "status": "COMPLETE",  
            "result": 5  
        }  
    ]  
}  
```

## Схема работы системы

![1742271591645](image/README/1742271591645.png)

## Тестирование

1. **Запуск тестов:**
   ```sh
   go test ./test 
   ```

## Дальнейшие улучшения

- Оптимизация вычислений с кешированием.


[^1]:  Проект при поддержке Яндекс Лицея и его лицеистов